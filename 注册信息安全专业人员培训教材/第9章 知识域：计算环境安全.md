第 9 章 知识域：计算环境安全



9.1 知识子域：操作系统安全

9.1.1 操作系统安全机制

操作系统的安全目标包括以下方面

（1）标识系统中的用户和进程身份鉴别

（2）依据系统安全策略对用户的操作进行访问控制

（3）保证系统自身的安全性和完整性

（4）监督系统运行的安全性

为实现安全目标，操作系统需要建立相应的各类安全机制，这些机制主要包括标识于鉴别、访问控制、权限管理、信道保护、安全审计等

1.标识与鉴别

标识与鉴别是操作系统基础的安全机制

操作系统利用标识来跟踪用户的操作，用户一旦完成了身份鉴别，就要对基于该标识的所偶有行为负责

（1）Windows 的身份标识与鉴别

Windows 的安全主体类型主要包括用户账户、组账户、计算机和服务，使用安全标识符（Security Identifier，SID）在系统内部进行标记

本地安全授权机构（LSA）

安全标识符是一串字符串，通常在安全主体创建时生成，由计算机名、当前时间、当前用户态线程的 CPU 耗费时间的总和 3 个参数决定以保证它的唯一性

一个完整的 SID 包括以下内容

- 用户和组的安全描述
- 48-bit 的身份特权（ID authority）
- 修订版本
- 可变的验证值

Windows 本地用户信息加密存储在注册表中，并且只有 system 账户才有权限进行访问

用户对鉴别信息的操作，例如更改密码等都通过一个以 system 权限运行的服务“Security Accounts Manager”来实现

（2）Linux 的身份标识与鉴别

Linux 使用用户标识号（User ID，UID）来标识和区别不同的用户

在系统内部管理进程和文件保护时使用 UID 字段

系统中可以存在多个拥有不同注册名、但 UID 相同的用户，这些使用不同注册名的用户是同一个用户

Linux 的用户信息存储在 /etc/passwd 中

注册名:口令:用户标识号:组标识号:用户名:用户主目录:命令解释程序 shell

/etc/passwd 是全局可读

Linux 系统使用 shadow 文件机制，将用户口令散列转移到该文件中，shadow 文件只有 root 可读可写，而同时 /etc/passwd 文件的密文域显示为一个 x，从而保护用户口令避免泄露

2.访问控制

对其访问必须进行控制的资源称为客体，必须控制对其客体的访问的活动资源称为主体

主体即访问的发起者，通常为进程、程序或用户

客体包括各种资源，如文件、设备等

访问控制中第三个元素是保护规则，它定义了主体与客体可能的相互操作途径

3.权限管理

操作系统机制和安全管理中，应遵循最小特权的原则

4.信道保护

对信息道路的保护涉及两个方面：一方面对显示信息道路的保护，防止非法或非授权信息经过显示信道；另一方面，要堵住隐蔽的信息通路，防止而已用户通过隐蔽信道

（1）正常信道的保护机制

（2）隐蔽信道的发现和处理

橘皮书中给出的是“隐蔽信道是允许进程以危害系统安全策略的方式传递信息的信道”

5.安全审计

安全审计包括审计事件、审计记录和审计日志等

审计事件事系统审计用户的最基本单位

9.1.2 操作系统安全配置要点

安全配置主要有以下几个方面：操作系统安全策略、关闭不必要的服务、关闭不必要的端口、开启审核策略、开启密码策略、开启账户策略、备份敏感文件、不显示上次登录名、禁止建立空连接和下载最新补丁等

1.安全补丁

2.最小化部署

3.远程访问控制

即使在网络层已经部署了网络防火墙，在操作系统上设置防火墙策略仍然是有必要的，纵深防御是提高系统安全性的基本原则之一。等级保护技术要求中也对操作系统层的访问控制提出要求，无论网络层是否提供访问控制

4.账户策略及口令策略

5.安全审计

6.其他安全策略



9.2 知识子域：信息收集与系统攻击

9.2.1 信息收集

1.信息收集的概念

2.信息收集的方法

（1）公开渠道信息收集

- 攻击定位
- 定点挖掘
- 漏洞查询

（2）利用网络服务信息收集

- 网络服务

whois、ping、tracert

- 服务旗标识别
- TCP/IP 协议栈检测

TCP/IP 协议栈指纹识别法

3.信息收集与分析的防范

所有不是必须向用户提供的信息，就是需要保护的信息

发布信息应采取最小化原则

重点单位应建立信息发布审查机制，对发布的信息进行审核，避免敏感信息的泄露

9.2.2 缓冲区溢出攻击

1.缓冲区基本概念

- 缓冲区

- 指针
- 寄存器

2.缓冲区溢出攻击原理

缓冲区溢出攻击分为栈溢出和堆溢出

3.缓冲区溢出的危害

4.缓冲区溢出的防范措施

5.其他类型的溢出

（1）整数溢出

（2）格式化字符串



9.3 知识子域：恶意代码防护

恶意代码（Malicious Software、Malware、Malicious code）

9.3.1 恶意代码预防

恶意代码的传播包括文件传播、网络传播、软件部署 3 种方式

（1）文件传播

（2）网络传播

（3）软件部署

针对恶意代码的预防包括安全策略、减少漏洞和减轻威胁 3 个方面的措施

（1）安全策略

（2）减少漏洞

（3）减轻威胁

9.3.2 恶意代码检测与分析

1.恶意代码检测

（1）特征码扫描

（2）行为检测

2.恶意代码分析

（1）静态分析

静态分析不需要实际执行恶意代码

（2）动态分析

动态分析是指在虚拟运行环境中，使用测试及监控软件，检测恶意代码行为，分析其执行流程及处理数据的状态，从而判断恶意代码的性质，并掌握其行为特点

9.3.3 恶意代码的清楚

1.感染引导区型恶意代码的清除

根据感染的类型分为主引导区和引导区恶意代码两种类型

2.文件依附型恶意代码的清除

3.独立型恶意代码的清除

4.嵌入型恶意代码的清除

9.3.4 基于互联网的恶意代码防护



9.4 知识子域：应用安全

应用安全是信息安全的一部分，包括应用程序运行安全和应用资源安全两个方面

应用程序运行安全是建立在对应用软件的需求、设计、编码、测试以及废弃等生命周期的每一个阶段加强安全防护的基础上，从而达到降低应用软件的安全漏洞问题的目的

对应用资源安全防护而言，需要保证合法用户能够通过安全策略合法的访问资源，同时也阻止攻击者访问、篡改任何受保护的资源。

应用安全不仅仅强调开发安全的应用系统，同时也应该强调应用系统的安全部署和安全运维

9.4.1 Web 应用安全

1.Web 体系架构

Web 体系架构包括传输协议（http、https）、服务端软件（Apache、IIS 等）、数据库、应用程序（使用PHP、Java等语言开发）、客户端（FireFox、Chrome等）

（1）Web 传输协议

超文本传输协议（Hypertext Transfer Protocol，HTTP）

目前最常用的 HTTP 协议是 HTTP/1.1

缺乏安全机制，导致了大量的安全问题，包括拒绝服务、电子欺骗、嗅探

HTTP 协议存在以下安全问题

- 明文传输数据
- 弱验证
- 缺乏状态跟踪

在 HTTP 的基础上加入了 SSL 协议，就是安全套接字层超文本传输协议（Hyper Text Transfer Protocol over Secure Socket Layer，HTTPS）

（2）服务端软件

Web 服务端软件（广泛使用的 Apache、IIS、Tomcat、WebSphere、WebLogic等）

Web 服务端软件面临的安全问题来自两个方面：一是软件本身的漏洞；一是软件配置上的缺陷

（3）客户端软件

Web 应用的客户端主要是各种浏览器

2.Web 应用的安全问题

（1）SQL 注入

SQL 注入攻击的防范可以从程序设计、代码编写、安全部署和使用 3 个方面采取措施

- 程序设计
- 代码编写
- 安全部署和使用

（2）跨站脚本

跨站脚本（Cross Site Script，XSS）

跨站脚本的防御措施主要是针对提交的信息进行严格过滤

（3）失效的验证和会话管理

失效的验证和会话管理（Broken Authentication and Session Management）

（4）不安全的对象直接引用

不安全的对象直接引用（Insecure Direct Object References，IDOR）

（5）跨站请求伪造

跨站请求伪造（Cross Site Request Forgery，CSRF）

（6）不安全的配置管理

（7）不安全的密码存储

（8）错误的访问控制

（9）传输保护不足

（10）未经验证的网址重定向

（11）不恰当的异常处理

（12）拒绝服务攻击

3.Web 安全防护技术

（1）Web 应用防火墙

Web 应用防火墙（Web Application Firewall，WAF）

很多 Web 应用防火墙产品是集 Web 防护、网页保护、负载均衡等功能与一体的 Web 整体安全防护设备

常见的功能包括以下几种

- 审计功能
- 访问控制设备
- Web 应用加固工具

Web 应用防火墙一般部署在 Web 服务旗和接入网之间，且为串行接入

如网络中还存在防火墙，则 Web 应用防火墙一般部署在防火墙之后，Web 服务器之前

部分 WAF 产品能够参与到安全事件发生的全过程，具备事前防范、事中防护、事后补救的能力

（2）网页防篡改

网页防篡改产品的技术原理主要包括几种

- 定时循环技术
- 摘要循环技术
- 事件触发防范技术
- 底层过滤技术

9.4.2 电子邮件安全

1.电子邮件工作机制

目前广泛使用的电子邮件协议包括：

- 简单邮件传输协议（Simple Main Transfer Protocol，SMTP）
- 邮局协议-版本 3（Post Office Protocol-Version 3，POP3）
- Internet 邮件访问协议（Internet Mail Access Protocol，IMAP）

2.电子邮件安全问题

电子邮件协议 SMTP、POP3 及 IMAP 都是基于纯 ASCII 文本的格式的应用层协议

（1）信息泄露

（2）邮件伪造

（3）垃圾邮件

3.电子邮件安全解决方案

（1）S/MIME

安全/多用途互联网邮件扩展（Secure/Multi-purpose Internet Mail Extensions，S/MIME）

S/MIME 保护的对象是邮件的主体

（2）PGP

PGP（Pretty Good Privacy）是一个基于公钥加密体系的开源软件

（3）使用 SSL 对会话进行保护

9.4.3 其他互联网应用

1.远程接入安全

取代 Telnet 的 SSH，把所有传输的数据进行了加密，并提供基于证书的身份验证、完整性保护等服务

2.域名系统安全

域名系统（Domain Name System，DNS）

DNS 欺骗也称 DNS 高速缓存污染

DNS 安全扩展（Domain Name System Security Extensions，DNSSEC），提供了一种来源鉴定和数据完整性的扩展，但不去保障可用性、加密性和证实域名不存在

3.即时通讯安全

即时通信（Instant Messaging，IM）



9.5 知识子域：数据安全

9.5.1 数据库安全

1.数据库安全要求

数据库安全涉及数据资产的安全存储和安全访问，对数据库安全要求包括以下方面

- 向合法用户提供可靠的信息服务
- 拒绝执行不正确的数据操作
- 拒绝非法用户对数据库的访问
- 能跟踪记录，以便为合规性检查、安全责任审查等提供证据和迹象等

2.数据库安全防护

数据库安全防护是指保护数据库运行安全以防止不合法的使用造成的数据泄露、更改或破坏，包括安全防护体系构建、安全运行监控和安全审计

在数据库系统投入生产运行之前，需要对数据库系统进行安全检测，检测分为以下两个方面

（1）数据库系统运行环境的检测

（2）数据库系统自身缺陷的安全检测

数据库活动监控（Database Activity Monitoring，DAM）

9.5.2 数据泄露防护

数据泄露防护（Data Leakage(Loss) Prevention，DLP）是建立在内容识别基础上，防止组织机构制定数据或信息资产违反安全策略流出组织机构的解决方案

对于业务流程中的每个环节，都应该关注以下问题

- 什么敏感数据需要发出
- 谁会发出敏感数据
- 这些数据要发往哪里
- 使用什么协议、端口等
- 违反了哪些安全策略
- 违规程度如何

数据库安全防护：事前检查、事中监控、事后审计



